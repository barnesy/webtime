<template>
  <Directory class="dark" bgImage="url(https://images.ctfassets.net/ncgri9n8y2w0/7zhoSe2v8mj6L0n5AiLyHQ/f5b32ed83acee938aa90ecb292a39aaf/comms-cloud.svg.png)">
    <template #page-header>
      <Header class="v1">
        <template>Community</template>
        <template #support>We have been proud members of the communities we serve for more than 160 years, and we will continue to give back with our time, talent and resources.</template>
      </Header>
    </template>

    <PageSection v-for="{ node } in $page.videoSeries.edges"
                   :key="node.id"
                   class="narrow"
                   bgColor="var(--white)">

        <template #title>{{ node.title }}</template>
        <p>{{ node.summary }} <a :href="'/community/' + node.slug" >View all posts</a></p>

        <CardGroup>
          <Card :url="'/community/'+ node.slug +'/' + vid.slug" v-for="vid in node.posts" :key="vid.id">
            <template #image>
              <g-image :src="vid.thumbnail.file.url" />
            </template>

            <template>
              {{ vid.title }}
            </template>

            <template #description>
              {{ vid.summary }}
            </template>
          </Card>
        </CardGroup>
      </PageSection>

  </Directory>
</template>

<page-query>
query ($territory: [String]){
  videoSeries:allContentfulVideoSeries (sortBy: "title", order: ASC, filter: {territory: {contains:$territory}}) {
    edges {
      node {
      	id
        slug
        title
        content
        summary
        posts (limit: 4, order: ASC) {
            id
            slug
            thumbnail {
              file {
                url
              }
            }
            youtubeId
            title
            content
            summary
            territory
    	  }
      }
  	}
  }
}
</page-query>

<script>
export default {
  metaInfo() {
    return {
      title: "Community",
      meta: [
        {
          name: 'description',
          content: "Southern Company Gas has been a proud member of the communities we serve for more than 160 years."
        },
        {
          property: 'og:title',
          content: "Community"
        },
        {
          property: 'og:description',
          content: "Southern Company Gas has been a proud member of the communities we serve for more than 160 years."
        },
        {
          property: 'og:image',
          content: "https://images.ctfassets.net/ncgri9n8y2w0/6bypYc7YxbIwgQ9MjBAjTU/5576f56b60645a72d6f7014238e80e55/leaf-hand.svg"
        },
        {
          property: 'og:url',
          content: "https://www.southerncompanygas.com/community"
        },
      ],
    }
  }
}
</script>

