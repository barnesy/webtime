<template>
  <Leaf>
    <PageSection class="narrow" padding="0 3rem 8rem">
      <h1>{{ $page.post.title }}</h1>
     <iframe width="100%" height="641" :src="'https://www.youtube.com/embed/' + $page.post.youtubeId" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

      <div v-html="content" />
    </PageSection>
  </Leaf>
</template>

<page-query>
  query Post($id: ID) {
    post: contentfulVideoPost (id: $id) {
      title
      slug
      thumbnail {
        file {
          url
        }
      }
      summary
      content
      youtubeId
    }
  }
</page-query>

<script>
import MarkdownIt from 'markdown-it'

let placeholder =  "https://images.ctfassets.net/ncgri9n8y2w0/4TrUKxtHvhJEMH1Ki0P8GO/c61275e1dbcea68f5600dbfe1211e7de/dark-green.png"

export default {
  metaInfo() {
    return {
      title: this.$page.post.title,
      meta: [
        {
          name: 'description',
          content: this.$page.post.summary
        },
        {
          property: 'og:title',
          content: this.$page.post.title
        },
        {
          property: 'og:description',
          content: this.$page.post.summary
        },
        {
          property: 'og:image',
          content: "https:" + this.ogImage
        },
        {
          property: 'og:url',
          content: "https://www.southerncompanygas.com/community/" + this.$context.series + "/" + this.$page.post.slug
        },
      ],
    }
  },
  data() {
    return {
      ogImage: placeholder
    }
  },
  computed: {
    content() {
      const md = new MarkdownIt()

      return md.render(this.$page.post.content)
    }
  },
  mounted() {
    let img = this.$page.post.thumbnail
    this.ogImage = (img) ?  img.file.url : placeholder
  }
}
</script>

<style lang="scss" scoped>
:deep .content {
  width: 100%;
}

.page-section :deep img {
  margin: 3rem auto;
  display: block;
}
</style>